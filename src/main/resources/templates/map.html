<!DOCTYPE html>
<!-- タイムリーフを使用 -->
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="css/map.css">
<title>スポットのMAP</title>
</head>
<body>
	<h1>ルート選択</h1>
	<!-- 地図を表示する要素 -->
    <div id="map"></div>

    <!-- 所要時間を表示する要素 -->
    <div id="duration"></div>

    <script>
        // Google Maps JavaScript APIの読み込み
        function initMap() {
            // 地図を表示する位置を設定
            const mapCenter = { lat: 34.052235, lng: -118.243683 }; // 例: ロサンゼルスの緯度経度

            // 地図を生成
            const map = new google.maps.Map(document.getElementById('map'), {
                center: mapCenter,
                zoom: 12, // ズームレベル
            });

            // 出発地、目的地、ウェイポイントの設定
            const directionsService = new google.maps.DirectionsService();
            const directionsRenderer = new google.maps.DirectionsRenderer({
                map: map,
            });

            const request = {
                origin: '大阪駅',
                destination: '海遊館',
                waypoints: [
                    { location: '梅田駅', stopover: true },
                    { location: '心斎橋駅', stopover: true },
                    // 必要に応じて追加のウェイポイントを指定
                ],
                travelMode: 'WALKING', // 交通手段を指定 (DRIVING, WALKING, BICYCLING など)
                optimizeWaypoints: true, // ウェイポイントの最適化を有効にする
            };

            // Directions サービスを使用して経路を計算
            directionsService.route(request, function(response, status) {
                if (status === 'OK') {
                    // 経路情報を地図に描画
                    directionsRenderer.setDirections(response);

                    // 所要時間を表示
                    const durationText = response.routes[0].legs.reduce((total, leg) => {
                        return total + leg.duration.text;
                    }, '');

                    document.getElementById('duration').innerHTML = '所要時間: ' + durationText;
                } else {
                    alert('ルートの取得中にエラーが発生しました: ' + status);
                }
            });
        }
    </script>

    <!-- Google Maps JavaScript APIの読み込み -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBwT0jZfclNhbmP1847xeSL0VWGfp9fOlU&callback=initMap" async defer></script>
	<!--リスト作成ボタン(ピン留めの場所が登録される)-->
	<button type="button" onclick="history.back()">一つ前の操作に戻る</button>
	<hr>
	<br>
	<div>
		<!--リスト作成ボタン(ピン留めの場所が登録される)-->
		<button class="btn" onclick="location.href='./purpose_osaka.html'">スポット選択に戻る</button>
		<br>
		<!--各顧客観光リストテーブル③に登録されるように-->
		<button class="btn" onclick="location.href='./mypage.html'">リスト作成</button>
	</div>
</body>
</html>